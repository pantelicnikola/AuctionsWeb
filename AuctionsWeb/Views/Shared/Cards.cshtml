@using Microsoft.AspNet.Identity
@model List<Auction>


<div class="card-deck">
    @foreach (var auction in Model)
    {
        var lastBidder = "No Bids Yet";
        var bids = auction.Bids.AsQueryable();
        bids = bids.OrderByDescending(a => a.Time);
        if (!bids.Count().Equals(0))
        {
            lastBidder = bids.First().AspNetUser.UserName;
        }
        <div class="col-sm-3 mt-4">
            <div class="card">
                <div class="card-header bg-transparent border-success">
                    @Html.ActionLink(auction.Name, "Auction", "Home", new { Id = auction.Id }, null)
                </div>
                <img class="card-img-top" src="http://via.placeholder.com/277x200" alt="Card image cap">
                <div class="card-body">
                    <p class="card-text">@auction.PriceNow</p>
                    <p class="card-text">@lastBidder</p>
                    <h5 class="card-title">@auction.State</h5>
                    @*<button class="btn btn-primary btn-sm" data-target="#myModal" data-toggle="modal" >Bid</button>*@
                    @*@Html.ActionLink("Bid", "ModalAction", "Home", new { id = auction.Id }, new { data_toggle = "modal" })*@
                    @Html.ActionLink("Bid", "ModalAction", "Home", new { id = auction.Id }, new { data_target = "#myModal", data_toggle = "modal" })
                    
                </div>
                <div class="card-footer">
                    <small class="text-muted">@DateTime.Now.ToShortTimeString()</small>
                </div>
            </div>
        </div>

        
        <div id="myModal" class="modal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                @Html.Partial("ModalContent", new AuctionsWeb.Models.BidModalModel(auction.Id, User.Identity.GetUserId(), auction.PriceNow))
            </div>
        </div>

    }
</div>

